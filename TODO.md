# To do

Here's what I'm currently working on:

### First release

- make one example that contains all kinds of "problems" spex can find?
  * reachability/coverage
  * correct json responses
  * minimal test cases that give rise to non-2xx responses

- tests for all examples in readme

- reenable ci for mac and win

- contributing.md
  + https://x.com/mitchellh/status/1852039089547309552

- release notes
  + focus on infra
  + bare minimum language and verifier
  + one example, for more see readme/website?

- move todo and roadmap to proper tickets

- website

### Documentation

#### Website

+ why/motivation/comparison?
  * reachability/coverage
  * correct json responses
  * minimal test cases that give rise to non-2xx responses
+ install
+ tutorial
+ (docs)
+ community
+ (news/blog)
+ (faq)
  * different from prior work
    - https://github.com/microsoft/restler-fuzzer
      https://www.code-intelligence.com/blog/stateful-rest-api-fuzzing
    - https://github.com/Fuzzapi/API-fuzzer
    - https://github.com/KissPeter/APIFuzzer
    - https://github.com/TNO-S3/WuppieFuzz
    - https://endava.github.io/cats/docs/intro
    - https://smithy.io

#### Other

- ARCHITECTURE.md?

### Features

#### Spex

- allow for control of # of test cases vs test case length
- use duration rather than numTests?
- print progress while testing

- Nice errors
  + Introduce FancyError datatype and display it in LibMain?
  + https://elm-lang.org/news/compiler-errors-for-humans
  + https://hackage.haskell.org/package/diagnose-2.5.1/docs/Error-Diagnose.html
  + https://medium.com/designing-atlassian/10-design-principles-for-delightful-clis-522f363bac87
  + https://github.com/charmbracelet/bubbletea
  + https://gleam.run/

- ensure shrinking shrinks to the same status code, i.e. doesn't uncover
  another error?

#### Spexup

- cache releases.json?

- check what versions are locally installed already

- basic ui:
  + spexup [update] [spexup|spex] -- install latest version
  + spexup list -- lists available releases
  + spexup install (spexup|spex) <version>

### Bugs

- abstract types don't need to pass scope checking, but they fail during generation:

    ```
    component PetStore where
    
    addPet : POST /pet @Pet
    getPet : GET /pet/{petId : Int} -> Pet
    ```

    spex: genUserDefined: impossible, scope checker
    CallStack (from HasCallStack):
      error, called at src/Spex/Verifier/Generator.hs:198:20 in spex-0.0.0-inplace:Spex.Verifier.Generator

  They should be generated by reuse only...

- abstract types get generated, if there are not previous values to draw from.
  Fix by allowing generation to throw?
- unique types don't get checked
- normal types should sometimes generate/sometimes reuse

### Refactor

- remove ExceptT?
- remove use of String
- structured logs, returns json object with one error or one test result?

### CI

- cache packages and remove second cabal update? use >> GITHUB_ENV if needed
  + caching should affect the need for the second update, are we mounting the right thing?

### Build system

- make linux work without docker locally?
  + cache files between docker and not should probably not be shared?

- -O2 release builds?
- enable concurrent RTS on executables?
- changelog generator (semantic commit messages)
- commit hook for conventional commits?
- move petstore to separate repo?
- public docker images for spex and spex-petshop
  + https://github.com/orgs/spex-lang/packages/container/spex/settings (at the bottom)
  + can we simply have an image that does `FROM scratch; ADD spex
    spex-demo-petshop /` and build that in the `install` target in the
    makefile? Thereby not having to rebuild anything?

### Tooling

- Highlighting: https://docs.github.com/en/get-started/writing-on-github/working-with-advanced-formatting/creating-and-highlighting-code-blocks#syntax-highlighting

